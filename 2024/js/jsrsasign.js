!function(){function e(e,t,a,r){return"pem_text"===e?a?KEYUTIL.getKey(t).pubKeyHex:KEYUTIL.getKey(t,r).prvKeyHex:"base64"===e?b64tohex(t):t}function t(e,t,a){if(!a)throw"Invalid private key";var r=new KJUR.crypto.Signature({alg:t});return r.init(a),"string"==typeof e?r.updateString(e):r.updateHex(ot.bytesToHex(e)),r.sign()}function a(t,a,r,n,i,o){try{if(!a)return"Public key is blank";if(!(i=e(n,i)))return"Signature key is blank";var c=new KJUR.crypto.Signature({alg:r});return c.init(o),"string"==typeof t?c.updateString(t):c.updateHex(ot.bytesToHex(t)),c.verify(i)?"Valid":"Signature is invalid"}catch(e){return e.message}}function r(e,t,a,r,n){var i,p,h=e.prvKeyObj,u=e.pubKeyObj;return"PKCS1"===t?r=!1:"PKCS5"===t?r=!0:a=void 0,p=r?KEYUTIL.getPEM(h,t+"PRV",n,a):KEYUTIL.getPEM(h,t+"PRV"),i=KEYUTIL.getPEM(u,"PKCS8PUB"),c.attr("href","data:application/octet-stream;,"+p),s.attr("href","data:application/octet-stream;,"+i),c.show(),s.show(),o.val(i),p}var n={"2b81040006":"secp112r1","2b8104001c":"secp128r1","2a8648ce3d030101":"secp192r1"},i={secp112r1:"1.3.132.0.6",secp128r1:"1.3.132.0.28",secp192r1:"1.2.840.10045.3.1.1",secp192k1:"1.3.132.0.31",secp224r1:"1.3.132.0.33"};window.ecdsa={},window.rsa={},ecdsa.sign=function(a,r,n,i,o,c){return i=e(n,i,!1,c),t(a,o+"withECDSA",i&&{d:i,curve:r})},rsa.sign=function(e,a,r,n){return t(e,r+"withRSA",KEYUTIL.getKey(a,n))},ecdsa.verify=function(t,r,n,i,o,c,s){return i=e(n,i,!0),a(t,i,o+"withECDSA",c,s,{xy:i,curve:r})},rsa.verify=function(e,t,r,n,i){return t=KEYUTIL.getKey(t),a(e,t,r+"withRSA",n,i,t)};var o=$("#public-key"),c=$("#download-image"),s=$("#download-public");c.attr("download","private.pem"),ecdsa.generate=function(e,t,a,n,i,p,h){o.val("");var u,g,d=KEYUTIL.generateKeypair("EC",t);if("pem_text"===a)g=r(d,n,i,p,h);else{c.hide(),s.hide();var f=new KJUR.crypto.ECDSA({curve:t}),l=f.generateKeyPairHex();u=l.ecpubhex,g=l.ecprvhex,"base64"===a&&(u=hextob64(u),g=hextob64(g)),o.val(u)}return g},rsa.generate=function(e,t,a,n,i,c){if(o.val(""),!(t<512)){return r(KEYUTIL.generateKeypair("RSA",t),a,n,i,c).replace("\r\n\r\n-----END","\r\n-----END")}};var p=$("#pem-format"),h=$("#cipher-algorithm-block"),u=$("#passpharse-wrap"),g=$("#passphrase-enabled-block"),d=$("#passphrase-enabled"),f=$("#passphrase-block");p.change(function(){var e=p.val();"PKCS8"===e?(h.hide(),u.show(),g.show(),d.change()):"PKCS5"===e?(h.show(),u.show(),g.hide(),f.show()):(h.hide(),u.hide(),g.show())}),p.change(),$('[data-toggle="key-type"]').each(function(){var e=$(this),t=$(e.data("target"));e.change(function(){t.toggle("pem_text"===e.val())}),e.change()}),$(window).on("methodLoad",function(){Object.keys(i).forEach(function(e){KJUR.asn1.x509.OID.name2oidList[e]=i[e]}),Object.keys(n).forEach(function(e){KJUR.crypto.OID.oidhex2name[e]=n[e]});var e=KJUR.crypto.ECDSA.getName;KJUR.crypto.ECDSA.getName=function(t){return n[t]?n[t]:e(t)},KJUR.crypto.ECParameterDB.regist("secp112r1",112,"db7c2abf62e35e668076bead208b","db7c2abf62e35e668076bead2088","659ef8ba043916eede8911702b22","db7c2abf62e35e7628dfac6561c5","1","09487239995a5ee76b55f9c2f098","a89ce5af8724c0a23e0e0ff77500",[])});var l=$("#algorithm");if("SHA256"===l.val()){var b=ot.getQuery();if(!b.algorithm)return;algorithm=b.algorithm.replace("withECDSA",""),l.find('option[value="'+algorithm+'"]').length&&l.val(algorithm)}}();